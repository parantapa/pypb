#!/usr/bin/env python2
# encoding: utf-8
"""
Read a dset file, from start to end.
"""

from __future__ import division, print_function

import sys
from datetime import datetime

import pypb.dset

def main():
    try:
        _, ifname = sys.argv
    except ValueError:
        print("Usage: dset-read-speed <ifname>")
        sys.exit(1)

    start = datetime.utcnow()
    with pypb.dset.open(ifname) as dset:
        for obj in dset:
            pass
    end = datetime.utcnow()
    print("Time to read:", end - start)

if __name__ == '__main__':
    main()


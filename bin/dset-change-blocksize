#!/usr/bin/env python2
# encoding: utf-8
"""
Change a new dataset with new blocksize.
"""

from __future__ import division, print_function, unicode_literals

import sys

import pypb.dset

def main():
    _, ifname, ofname, blocksize = sys.argv

    din = pypb.dset.open(ifname)

    params = {
        "block_length": int(blocksize),
        "compression": din.header["compression"]
    }
    with pypb.dset.open(ofname, "w", **params) as dout:
        dout.extend(din)

if __name__ == '__main__':
    main()

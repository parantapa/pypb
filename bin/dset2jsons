#!/usr/bin/env python2
# encoding: utf-8
"""
Convert a dset file to newline separated json file
"""

from __future__ import print_function

import sys
import json
import gzip

import pypb.dset as ds

def main():
    try:
        _, ifname, ofname = sys.argv
    except ValueError:
        print("Usage: dset2jsons <ifname.dset> <ofname.jsons.gz>")
        sys.exit(1)

    with ds.open(ifname) as dset:
        with gzip.open(ofname, "wb", 6) as fout:
            for obj in dset:
                fout.write(json.dumps(obj) + "\n")

if __name__ == '__main__':
    main()
